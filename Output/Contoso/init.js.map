{"version":3,"sources":["init.ts"],"names":[],"mappings":"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","file":"init.js","sourcesContent":["/// <reference path=\"../Contoso/Contoso.ts\" />\n/// <reference path=\"../../Controllers/Example/exampleList.ts\" />\nmodule Contoso {\n    export interface IInit {\n        getDependency(filename: string, filetype: string, successCallback: Function): void;\n        dataAttributeTag: string;\n        rootSiteCollectionPrefix: string;\n    }\n    class initController implements IInit {\n        getDependency(filename: string, filetype: string, successCallback: Function) {\n            if (filetype == \"js\") { //if filename is a external JavaScript file\n                var inject: any = document.createElement('script')\n                inject.setAttribute(\"type\", \"text/javascript\")\n                inject.setAttribute(\"src\", filename)\n            }\n            else if (filetype == \"css\") { //if filename is an external CSS file\n                var inject: any = document.createElement(\"link\")\n                inject.setAttribute(\"rel\", \"stylesheet\")\n                inject.setAttribute(\"type\", \"text/css\")\n                inject.setAttribute(\"href\", filename)\n            }\n            if (typeof inject != \"undefined\") {\n                var head = document.getElementsByTagName('head')[0], done = false;\n                // Attach handlers for all browsers\n                inject.onload = inject.onreadystatechange = function () {\n                    if (!done && (!this.readyState || this.readyState == 'loaded' || this.readyState == 'complete')) {\n                        done = true;\n                        inject.onload = inject.onreadystatechange = null;\n                        if (filetype == \"js\") { head.removeChild(inject); }\n                    }\n                };\n                head.appendChild(inject);\n            }\n        }\n        domBuilder() {\n            if (document.getElementById(\"handlebarsTemplates\") === null) {\n                var handlebarsTemplates = document.createElement('div');\n                handlebarsTemplates.setAttribute(\"id\", \"handlebarsTemplates\")\n                document.body.appendChild(handlebarsTemplates);\n            }\n            Contoso.init.loadJs();\n        }\n        loadJs() {\n            Contoso.init.getDependency(Contoso.init.rootSiteCollectionPrefix + '/CSOM/vendor.js', 'js', function () {\n                console.log(\"Successfully boostrapped Vendor JS\");\n                Contoso.init.getDependency(Contoso.init.rootSiteCollectionPrefix + '/CSOM/bundle.js', 'js', function () {\n                    if (typeof Controllers === 'undefined' || typeof Contoso.Helpers === 'undefined') {\n                        if (console !== undefined) {\n                            console.log('Failed to bootstrap CSOM JS');\n                        }\n                    } else {\n                        Contoso.Helpers.log('Successfully bootstraped CSOM JS');\n                    }\n                });\n            });\n        }\n        loadCss() {\n            Contoso.init.getDependency(Contoso.init.rootSiteCollectionPrefix + '/CSOM/bundle.css', 'css', function () {\n                Contoso.Helpers.log('Successfully bootstraped CSOM CSS');\n            });\n            Contoso.init.getDependency(Contoso.init.rootSiteCollectionPrefix + '/CSOM/vendor.css', 'css', function () {\n                Contoso.Helpers.log('Successfully bootstraped Vendor CSS');\n            });\n            Contoso.init.getDependency('//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.css', 'css', function () {\n            });\n        }\n        rootSiteCollectionPrefix = \"/sites\";\n        dataAttributeTag = \"data-controller\";\n    }\n    export var init = new initController();\n    if (window.location.hostname !== \"localhost\") {\n        init.domBuilder();\n        init.loadCss();\n    }\n}"]}